import pandas as pd

# 원본 파일 읽기
df = pd.read_csv("data.csv")

# 컬럼 매핑 딕셔너리 정의
column_mapping = {
    # 문1. 시급한 과제
Q1_맵 = {
    1: "국가 비전 제시",
    2: "각종 의혹 해소",
    3: "공약 실천 방안 마련",
    4: "국민 통합"
}

# 문2. 취임사 관심도
Q2_맵 = {
    1: "매우 관심이 있다",
    2: "대체로 관심이 있다",
    3: "별로 관심이 없다",
    4: "전혀 관심이 없다"
}

# 문3. 핵심 가치 키워드
Q3_맵 = {
    1: "공정", 2: "정의", 3: "평화", 4: "상생", 5: "회복", 6: "혁신",
    7: "인권", 8: "안전", 9: "통합", 10: "기타", 11: "경제",
    12: "복지", 13: "외교", 14: "신뢰", 15: "발전"
}

# 문4. 중점 현안
Q4_맵 = {
    1: "일자리 창출 등 경제 활성화",
    2: "물가 및 서민 생활 안정",
    3: "정치 제도 개혁",
    4: "사회갈등 해소를 위한 국민 통합",
    5: "부동산 안정",
    6: "국제외교 및 남북관계 긴장 완화",
    7: "사회 불공정 타파",
    8: "의료 등 복지 향상",
    9: "지역 균형 발전",
    10: "입시 제도 등 교육 개혁",
    11: "부정부패 척결",
    12: "출산율 제고와 양육 문제",
    13: "기타"
}

# 문5. 국정 비전
Q5_맵 = {
    1: "고령화 저출산 문제 해결",
    2: "신성장동력 첨단기술 육성",
    3: "신규 일자리 창출",
    4: "지역 균형 발전",
    5: "한류 문화 활성화",
    6: "사회 불평등 해소",
    7: "경제 양극화 해소",
    8: "한반도 평화와 통일 프로세스 구축",
    9: "창의적 인재 육성",
    10: "정치적 갈등 해소",
    11: "기타",
    12: "기후위기 등 환경문제 대응"
}

# 문6. 인상적 대통령
Q6_맵 = {
    1: "문재인(19대)", 2: "박근혜(18대)", 3: "이명박(17대)", 4: "노무현(16대)",
    5: "김대중(15대)", 6: "김영삼(14대)", 7: "노태우(13대)", 8: "전두환(11~12대)",
    9: "최규하(10대)", 10: "박정희(5~9대)", 11: "윤보선(4대)", 12: "이승만(1~3대)",
    13: "없다"
}

# 문8. 미래 전망 (5점 척도)
Q8_맵 = {
    1: "전혀 그렇지 않다",
    2: "그렇지 않다",
    3: "보통이다",
    4: "그렇다",
    5: "매우 그렇다"
}

# 문9. 사회계층 인식
Q9_맵 = {
    1: "하층", 2: "중하층", 3: "중간층", 4: "중상층", 5: "상층"
}

# 문10. 이념 성향
Q10_맵 = {
    1: "진보", 2: "중도", 3: "보수"
}

# SQ1. 성별
SQ1_맵 = {
    1: "남성", 2: "여성"
}

# SQ2_R. 연령대 리코딩
SQ2_R_맵 = {
    1: "18~29세", 2: "30대", 3: "40대", 4: "50대", 5: "60대 이상"
}

# SQ3. 지역
SQ3_맵 = {
    1: "서울", 2: "부산", 3: "대구", 4: "인천", 5: "광주", 6: "대전", 7: "울산",
    8: "경기", 9: "강원", 10: "충북", 11: "충남", 12: "전북", 13: "전남", 14: "경북",
    15: "경남", 16: "제주", 17: "세종"
}

# DQ1. 직업
DQ1_맵 = {
    1: "기업체 경영주", 2: "자영업주", 3: "전문직", 4: "관리직", 5: "사무직",
    6: "서비스직", 7: "기술/기능직", 8: "판매직", 9: "생산직", 10: "농업 등 1차 산업",
    11: "군인·경찰", 12: "학생", 13: "전업 주부", 14: "무직/실업", 15: "기타"
}

# DQ2. 최종학력
DQ2_맵 = {
    0: "무학", 1: "초등학교 재학", 2: "초등학교 졸업", 3: "중학교 재학", 4: "중학교 졸업",
    5: "고등학교 재학", 6: "고등학교 졸업", 7: "전문대 재학", 8: "전문대 졸업",
    9: "대학교 재학", 10: "대학교 졸업", 11: "대학원 재학", 12: "대학원 졸업", 13: "기타"
}

# DQ3. 월 가구소득
DQ3_맵 = {
    1: "100만원 미만", 2: "100~200만원 미만", 3: "200~300만원 미만", 4: "300~400만원 미만",
    5: "400~500만원 미만", 6: "500~600만원 미만", 7: "600~700만원 미만",
    8: "700~800만원 미만", 9: "800만원 이상", 0: "모름"
}

}

# 컬럼 이름 변경
df.rename(columns=column_mapping, inplace=True)

# 변경된 결과 저장 (선택)
# df.to_csv("답변 파일.csv", index=False)

# 확인
# print(df.head())

# ✔️ 성별 vs 기후변화 심각성 인식
cross_tab = pd.crosstab(df['가구 월평균 소득'], df['기후변화 심각성 인식'], normalize='index') * 100
print("\n[가구 월평균 소득 vs 기후변화 심각성 인식 비율 (%)]:")
print(cross_tab.round(1))

# 시각화
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from matplotlib import rcParams

# ✅ 한글 폰트 설정 (Windows)
plt.rcParams['font.family'] = 'Malgun Gothic'
# ✅ 마이너스 깨짐 방지
plt.rcParams['axes.unicode_minus'] = False

# Heatmap 시각화
plt.figure(figsize=(10, 6))
sns.heatmap(
    cross_tab,
    annot=True,
    fmt=".1f",
    cmap="YlGnBu",
    cbar_kws={'label': '비율 (%)'}
)

plt.title('가구 월평균 소득 vs 심각성 인식 교차분석 (비율 %)', fontsize=14)
plt.xlabel('가구 월평균 소득')
plt.ylabel('기후변화 관심도')
plt.tight_layout()
plt.show()